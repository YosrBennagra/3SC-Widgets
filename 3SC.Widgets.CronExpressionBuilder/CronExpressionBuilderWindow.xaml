<Window x:Class="_3SC.Widgets.CronExpressionBuilder.CronExpressionBuilderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:_3SC.Widgets.CronExpressionBuilder"
        Title="Cron Expression Builder"
        Width="450"
        Height="600"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize">

    <Window.Resources>
        <!-- Colors -->
        <SolidColorBrush x:Key="BackgroundBrush"
                Color="#1E1E1E"/>
        <SolidColorBrush x:Key="BorderBrush"
                Color="#3F3F46"/>
        <SolidColorBrush x:Key="HeaderBrush"
                Color="#2D2D30"/>
        <SolidColorBrush x:Key="ForegroundBrush"
                Color="#E0E0E0"/>
        <SolidColorBrush x:Key="AccentBrush"
                Color="#0078D4"/>
        <SolidColorBrush x:Key="SecondaryBrush"
                Color="#2A2A2A"/>
        <SolidColorBrush x:Key="HoverBrush"
                Color="#3E3E42"/>

        <!-- ComboBox Style -->
        <Style x:Key="CronComboBox"
                TargetType="ComboBox">
            <Setter Property="Background"
                    Value="{StaticResource SecondaryBrush}"/>
            <Setter Property="Foreground"
                    Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush"
                    Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
            <Setter Property="Padding"
                    Value="8,4"/>
            <Setter Property="FontSize"
                    Value="13"/>
            <Setter Property="Height"
                    Value="32"/>
        </Style>

        <!-- Label Style -->
        <Style x:Key="CronLabel"
                TargetType="TextBlock">
            <Setter Property="Foreground"
                    Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="FontSize"
                    Value="12"/>
            <Setter Property="FontWeight"
                    Value="SemiBold"/>
            <Setter Property="Margin"
                    Value="0,0,0,4"/>
        </Style>

        <!-- Button Style -->
        <Style x:Key="CronButton"
                TargetType="Button">
            <Setter Property="Background"
                    Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground"
                    Value="White"/>
            <Setter Property="BorderThickness"
                    Value="0"/>
            <Setter Property="Padding"
                    Value="16,8"/>
            <Setter Property="FontSize"
                    Value="13"/>
            <Setter Property="Cursor"
                    Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                    VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver"
                        Value="True">
                    <Setter Property="Background"
                            Value="#1E88E5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- ListBox Style for Common Patterns -->
        <Style x:Key="PatternListBox"
                TargetType="ListBox">
            <Setter Property="Background"
                    Value="{StaticResource SecondaryBrush}"/>
            <Setter Property="BorderBrush"
                    Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
            <Setter Property="Foreground"
                    Value="{StaticResource ForegroundBrush}"/>
        </Style>

        <Style x:Key="PatternListBoxItem"
                TargetType="ListBoxItem">
            <Setter Property="Padding"
                    Value="8,6"/>
            <Setter Property="Cursor"
                    Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver"
                        Value="True">
                    <Setter Property="Background"
                            Value="{StaticResource HoverBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border Background="{StaticResource BackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0"
                    Background="{StaticResource HeaderBrush}"
                    CornerRadius="8,8,0,0"
                    MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Grid>
                    <TextBlock Text="â²ï¸ Cron Expression Builder"
                               Foreground="{StaticResource ForegroundBrush}"
                               FontSize="14"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"
                               Margin="12,0"/>
                    <Button Content="âœ•"
                            Width="40"
                            Height="40"
                            HorizontalAlignment="Right"
                            Background="Transparent"
                            Foreground="{StaticResource ForegroundBrush}"
                            BorderThickness="0"
                            FontSize="16"
                            Click="Close_Click"
                            Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background"
                                        Value="Transparent"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}">
                                                <ContentPresenter HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver"
                                            Value="True">
                                        <Setter Property="Background"
                                                Value="#E81123"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>

            <!-- Content -->
            <ScrollViewer Grid.Row="1"
                    VerticalScrollBarVisibility="Auto"
                    Padding="16">
                <StackPanel>
                    <!-- Dropdown Builders Section -->
                    <TextBlock Text="Build Expression"
                               Style="{StaticResource CronLabel}"
                               FontSize="14"
                               Margin="0,0,0,12"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Minute -->
                        <StackPanel Grid.Row="0"
                                Grid.Column="0"
                                Margin="0,0,8,12">
                            <TextBlock Text="Minute (0-59)"
                                    Style="{StaticResource CronLabel}"/>
                            <ComboBox ItemsSource="{Binding MinuteOptions}"
                                      SelectedItem="{Binding SelectedMinute}"
                                      Style="{StaticResource CronComboBox}"/>
                        </StackPanel>

                        <!-- Hour -->
                        <StackPanel Grid.Row="0"
                                Grid.Column="1"
                                Margin="8,0,0,12">
                            <TextBlock Text="Hour (0-23)"
                                    Style="{StaticResource CronLabel}"/>
                            <ComboBox ItemsSource="{Binding HourOptions}"
                                      SelectedItem="{Binding SelectedHour}"
                                      Style="{StaticResource CronComboBox}"/>
                        </StackPanel>

                        <!-- Day of Month -->
                        <StackPanel Grid.Row="1"
                                Grid.Column="0"
                                Margin="0,0,8,12">
                            <TextBlock Text="Day of Month (1-31)"
                                    Style="{StaticResource CronLabel}"/>
                            <ComboBox ItemsSource="{Binding DayOfMonthOptions}"
                                      SelectedItem="{Binding SelectedDayOfMonth}"
                                      Style="{StaticResource CronComboBox}"/>
                        </StackPanel>

                        <!-- Month -->
                        <StackPanel Grid.Row="1"
                                Grid.Column="1"
                                Margin="8,0,0,12">
                            <TextBlock Text="Month (1-12)"
                                    Style="{StaticResource CronLabel}"/>
                            <ComboBox ItemsSource="{Binding MonthOptions}"
                                      SelectedItem="{Binding SelectedMonth}"
                                      Style="{StaticResource CronComboBox}"/>
                        </StackPanel>

                        <!-- Day of Week -->
                        <StackPanel Grid.Row="2"
                                Grid.Column="0"
                                Grid.ColumnSpan="2"
                                Margin="0,0,0,12">
                            <TextBlock Text="Day of Week (0=Sunday, 6=Saturday)"
                                    Style="{StaticResource CronLabel}"/>
                            <ComboBox ItemsSource="{Binding DayOfWeekOptions}"
                                      SelectedItem="{Binding SelectedDayOfWeek}"
                                      Style="{StaticResource CronComboBox}"/>
                        </StackPanel>
                    </Grid>

                    <!-- Expression Output -->
                    <Border Background="{StaticResource SecondaryBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="12"
                            Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Unix Cron Expression"
                                    Style="{StaticResource CronLabel}"/>
                            <TextBox Text="{Binding CronExpression, Mode=OneWay}"
                                     IsReadOnly="True"
                                     Background="Transparent"
                                     Foreground="{StaticResource AccentBrush}"
                                     BorderThickness="0"
                                     FontFamily="Consolas"
                                     FontSize="14"
                                     Margin="0,0,0,8"/>

                            <TextBlock Text="Quartz Expression"
                                    Style="{StaticResource CronLabel}"/>
                            <TextBox Text="{Binding QuartzExpression, Mode=OneWay}"
                                     IsReadOnly="True"
                                     Background="Transparent"
                                     Foreground="{StaticResource AccentBrush}"
                                     BorderThickness="0"
                                     FontFamily="Consolas"
                                     FontSize="14"
                                     Margin="0,0,0,8"/>

                            <Button Content="ðŸ“‹ Copy to Clipboard"
                                    Command="{Binding CopyExpressionCommand}"
                                    Style="{StaticResource CronButton}"
                                    HorizontalAlignment="Left"/>
                        </StackPanel>
                    </Border>

                    <!-- Human Readable Output -->
                    <Border Background="{StaticResource SecondaryBrush}"
                            BorderBrush="{StaticResource AccentBrush}"
                            BorderThickness="2"
                            CornerRadius="4"
                            Padding="12"
                            Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="ðŸ“– Human Readable"
                                    Style="{StaticResource CronLabel}"/>
                            <TextBlock Text="{Binding HumanReadable}"
                                       Foreground="{StaticResource ForegroundBrush}"
                                       FontSize="13"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <!-- Next Run Times -->
                    <TextBlock Text="â° Next 5 Run Times"
                            Style="{StaticResource CronLabel}"
                            FontSize="14"
                            Margin="0,0,0,8"/>
                    <Border Background="{StaticResource SecondaryBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="8"
                            Margin="0,0,0,16">
                        <ItemsControl ItemsSource="{Binding NextRunTimes}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}"
                                               Foreground="{StaticResource ForegroundBrush}"
                                               FontFamily="Consolas"
                                               FontSize="12"
                                               Margin="0,2"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Border>

                    <!-- Common Patterns Library -->
                    <TextBlock Text="ðŸ“š Common Patterns"
                            Style="{StaticResource CronLabel}"
                            FontSize="14"
                            Margin="0,0,0,8"/>
                    <ListBox ItemsSource="{Binding CommonPatterns}"
                             Style="{StaticResource PatternListBox}"
                             ItemContainerStyle="{StaticResource PatternListBoxItem}"
                             Height="150"
                             ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{Binding Name}"
                                               Foreground="{StaticResource ForegroundBrush}"
                                               VerticalAlignment="Center"/>
                                    <Button Grid.Column="1"
                                            Content="Apply"
                                            Command="{Binding DataContext.ApplyPatternCommand, RelativeSource={RelativeSource AncestorType=ListBox}}"
                                            CommandParameter="{Binding}"
                                            Style="{StaticResource CronButton}"
                                            Padding="8,4"
                                            FontSize="11"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!-- Reset Button -->
                    <Button Content="ðŸ”„ Reset to Default"
                            Command="{Binding ResetCommand}"
                            Style="{StaticResource CronButton}"
                            HorizontalAlignment="Center"
                            Margin="0,16,0,0"
                            Background="#555555"/>
                </StackPanel>
            </ScrollViewer>

            <!-- Resize Grip -->
            <Grid Grid.Row="1"
                    VerticalAlignment="Bottom"
                    HorizontalAlignment="Right">
                <Path Data="M 0,10 L 10,10 L 10,0"
                      Stroke="{StaticResource BorderBrush}"
                      StrokeThickness="1"
                      Margin="0,0,4,4"
                      Cursor="SizeNWSE"
                      MouseLeftButtonDown="ResizeGrip_MouseLeftButtonDown"/>
            </Grid>
        </Grid>
    </Border>
</Window>
