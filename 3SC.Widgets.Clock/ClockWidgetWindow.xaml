<local:WidgetWindowBase x:Class="_3SC.Widgets.Clock.ClockWidgetWindow"
                        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                        xmlns:local="clr-namespace:_3SC.Widgets.Clock"
                        mc:Ignorable="d"
                        Title="ClockWidget"
                        Width="300"
                        Height="80"
                        WindowStyle="None"
                        AllowsTransparency="True"
                        Background="Transparent"
                        ShowInTaskbar="False"
                        Topmost="False"
                        ResizeMode="NoResize">

    <Window.Resources>
        <!-- Dark Theme Colors (matching 3SC Dark.xaml) -->
        <SolidColorBrush x:Key="WidgetSurface"
                         Color="#D0080810"/>
        <SolidColorBrush x:Key="WidgetText"
                         Color="#FFF1F5F9"/>
        <SolidColorBrush x:Key="Accent"
                         Color="#FF2DD4BF"/>
        <SolidColorBrush x:Key="SurfaceElevated"
                         Color="#FF16161F"/>
        <SolidColorBrush x:Key="Border"
                         Color="#FF2A2A3A"/>
        <SolidColorBrush x:Key="SurfaceHover"
                         Color="#FF1C1C28"/>
        <SolidColorBrush x:Key="TextPrimary"
                         Color="#FFF1F5F9"/>

        <!-- Styled ContextMenu matching 3SC -->
        <Style TargetType="ContextMenu">
            <Setter Property="Background"
                    Value="#FF16161F"/>
            <Setter Property="BorderBrush"
                    Value="#FF2A2A3A"/>
            <Setter Property="BorderThickness"
                    Value="1"/>
            <Setter Property="Padding"
                    Value="6"/>
            <Setter Property="SnapsToDevicePixels"
                    Value="True"/>
            <Setter Property="HasDropShadow"
                    Value="True"/>
            <Setter Property="FontSize"
                    Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ContextMenu">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="32"
                                                  ShadowDepth="8"
                                                  Opacity="0.4"
                                                  Color="#000000"/>
                            </Border.Effect>
                            <StackPanel IsItemsHost="True"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styled MenuItem matching 3SC -->
        <Style TargetType="MenuItem">
            <Setter Property="Background"
                    Value="Transparent"/>
            <Setter Property="Foreground"
                    Value="#FFF1F5F9"/>
            <Setter Property="Padding"
                    Value="12,10"/>
            <Setter Property="MinHeight"
                    Value="36"/>
            <Setter Property="FontSize"
                    Value="13"/>
            <Setter Property="Cursor"
                    Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0"
                                CornerRadius="6"
                                Margin="2"
                                SnapsToDevicePixels="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"
                                                      MinWidth="24"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Grid.Column="0"
                                                  ContentSource="Icon"
                                                  Margin="8,0,8,0"
                                                  VerticalAlignment="Center"/>
                                <ContentPresenter Grid.Column="1"
                                                  ContentSource="Header"
                                                  Margin="{TemplateBinding Padding}"
                                                  VerticalAlignment="Center"
                                                  RecognizesAccessKey="True"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted"
                                     Value="True">
                                <Setter TargetName="Border"
                                        Property="Background"
                                        Value="#FF1C1C28"/>
                            </Trigger>
                            <Trigger Property="IsEnabled"
                                     Value="False">
                                <Setter Property="Opacity"
                                        Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styled Separator matching 3SC -->
        <Style TargetType="Separator">
            <Setter Property="Background"
                    Value="#FF2A2A3A"/>
            <Setter Property="Height"
                    Value="1"/>
            <Setter Property="Margin"
                    Value="8,6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Separator">
                        <Border Background="{TemplateBinding Background}"
                                Height="{TemplateBinding Height}"
                                Margin="{TemplateBinding Margin}"
                                Opacity="0.4"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="6">
        <!-- Outer container with rounded corners and semi-transparent backdrop -->
        <Border x:Name="RootBorder"
                CornerRadius="12"
                Padding="0"
                SnapsToDevicePixels="True"
                Background="{DynamicResource WidgetSurface}"
                Cursor="Hand"
                PreviewMouseLeftButtonDown="RootBorder_PreviewMouseLeftButtonDown"
                PreviewMouseLeftButtonUp="RootBorder_PreviewMouseLeftButtonUp"
                PreviewMouseMove="RootBorder_PreviewMouseMove"
                MouseRightButtonUp="RootBorder_MouseRightButtonUp">
            <Border.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Settings..."
                              Click="Settings_Click">
                        <MenuItem.Icon>
                            <TextBlock Text="&#xE713;"
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="14"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator/>
                    <MenuItem x:Name="LockWidgetMenuItem"
                              Header="Lock Widget"
                              Click="LockWidget_Click"
                              IsCheckable="True"/>
                    <MenuItem x:Name="ResizeToggleMenuItem"
                              Header="Resize Handles"
                              Click="ResizeToggle_Click"
                              IsCheckable="True"/>
                    <Separator/>
                    <MenuItem Header="Remove Widget"
                              Click="RemoveWidget_Click"/>
                </ContextMenu>
            </Border.ContextMenu>

            <Grid Margin="12"
                  RenderTransformOrigin="0.5,0.5">
                <Grid.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform/>
                        <SkewTransform/>
                        <RotateTransform Angle="0.002"/>
                        <TranslateTransform/>
                    </TransformGroup>
                </Grid.RenderTransform>

                <Rectangle x:Name="ResizeOutline"
                           Stroke="{DynamicResource Border}"
                           StrokeThickness="1"
                           RadiusX="12"
                           RadiusY="12"
                           Visibility="Collapsed"/>

                <Thumb x:Name="ResizeTop"
                       Width="12"
                       Height="12"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Top"
                       Cursor="SizeNS"
                       DragDelta="ResizeTop_DragDelta"
                       Visibility="Collapsed"
                       Margin="0,-6,0,0"
                       Panel.ZIndex="10">
                    <Thumb.Template>
                        <ControlTemplate TargetType="Thumb">
                            <Border Background="{DynamicResource Border}"
                                    CornerRadius="6"/>
                        </ControlTemplate>
                    </Thumb.Template>
                </Thumb>
                <Thumb x:Name="ResizeBottom"
                       Width="12"
                       Height="12"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Bottom"
                       Cursor="SizeNS"
                       DragDelta="ResizeBottom_DragDelta"
                       Visibility="Collapsed"
                       Margin="0,0,0,-6"
                       Panel.ZIndex="10">
                    <Thumb.Template>
                        <ControlTemplate TargetType="Thumb">
                            <Border Background="{DynamicResource Border}"
                                    CornerRadius="6"/>
                        </ControlTemplate>
                    </Thumb.Template>
                </Thumb>
                <Thumb x:Name="ResizeLeft"
                       Width="12"
                       Height="12"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Center"
                       Cursor="SizeWE"
                       DragDelta="ResizeLeft_DragDelta"
                       Visibility="Collapsed"
                       Margin="-6,0,0,0"
                       Panel.ZIndex="10">
                    <Thumb.Template>
                        <ControlTemplate TargetType="Thumb">
                            <Border Background="{DynamicResource Border}"
                                    CornerRadius="6"/>
                        </ControlTemplate>
                    </Thumb.Template>
                </Thumb>
                <Thumb x:Name="ResizeRight"
                       Width="12"
                       Height="12"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Center"
                       Cursor="SizeWE"
                       DragDelta="ResizeRight_DragDelta"
                       Visibility="Collapsed"
                       Margin="0,0,-6,0"
                       Panel.ZIndex="10">
                    <Thumb.Template>
                        <ControlTemplate TargetType="Thumb">
                            <Border Background="{DynamicResource Border}"
                                    CornerRadius="6"/>
                        </ControlTemplate>
                    </Thumb.Template>
                </Thumb>

                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                    <!-- TextBlock showing time -->
                    <TextBlock x:Name="TimeTextBlock"
                               FontFamily="Segoe UI"
                               FontSize="28"
                               FontWeight="Normal"
                               Foreground="{DynamicResource WidgetText}"
                               HorizontalAlignment="Center"
                               TextOptions.TextFormattingMode="Ideal"
                               TextOptions.TextRenderingMode="ClearType"
                               SnapsToDevicePixels="True"
                               RenderTransformOrigin="0.5,0.5">
                        <TextBlock.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="-0.036"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </TextBlock.RenderTransform>
                    </TextBlock>

                    <!-- Timezone label -->
                    <TextBlock x:Name="TimeZoneLabel"
                               FontFamily="Segoe UI"
                               FontSize="11"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource Accent}"
                               FontWeight="SemiBold"
                               Margin="0,4,0,0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</local:WidgetWindowBase>
